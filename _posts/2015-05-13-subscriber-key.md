---
layout: page
title: "Subscriber Key"
subtitle: "Updating Subscriber Key"
category: features
date: 2015-05-14 12:00:00
order: 1
---
Prior to release 4.0.0, the SDK would set a default subscriber key to a unique hash called DeviceId.  Because this can cause duplicate records for companies who import contacts, the SDK stopped setting a default subscriber key.

Follow these directions to set a default subscriber key to the DeviceId generated by the SDK:

> Note that this method could still cause duplicate records if you also import contact records into your Marketing Cloud account. Be aware of the implications of this approach.

When the mobile app sends a registration to the Marketing Cloud, the app adds an event to the EventBus when the sending the registration. You can add a callback event in your Application class for the RegistrationEvent. For directions on how to setup a class to receive an event callback, review the [EventBus](eventbus.html) documentation.

~~~
    public class YourApplication extends Application {
    …
    …
        public void onEvent(final RegistrationEvent event) {
            if (TextUtils.isEmpty(event.getSubscriberKey())) {
                ETPush.getInstance().setSubscriberKey(event.getDeviceId());
            }
        }
    …
    …
~~~
You can also set the subsciber key to a specific value provided by your customer as the unique identifier for the contact. You can use a mobile number, email address, or other appropriate value as necessary.

This example (taken from the <a href="https://github.com/ExactTarget/JB4A-SDK-Android/tree/master/JB4A-SDK-Explorer" target="_blank">Journey Builder for Apps SDK Explorer for Android</a>) uses a PreferenceActivity to allow your users to enter or change the subscriber key in their Contact record.

The ETPush.getInstance().setSubscriberKey() method will create a new registration record and send it to the Marketing Cloud. The contact record may take up to 15 minutes to record this value. If the app connect access the Internet, the SDK will save the update and send whenever the network becomes available. The call also returns a true or false value indicating the success of the call.

> By default, if your app does not set the subscriber key using setSubscriberKey(), the Marketing Cloud will match the registration sent with a Contact Record that matches the System Token included in the registration payload. If the Marketing Cloud does not find a match, the Marketing Cloud will set a new subscriber key will be set and will not send the value back to the SDK.

~~~ 
public class SettingsActivity extends PreferenceActivity {
    private static final String TAG = "SettingsActivity";
    …
    …
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        addPreferencesFromResource(R.xml.preferences);
    …
    …
       //
        // SUBSCRIBER KEY PREFERENCE
        //
        final Preference skPref = findPreference(CONSTS.KEY_PREF_SUBSCRIBER_KEY);
        if (!sp.getString(CONSTS.KEY_PREF_SUBSCRIBER_KEY, "").isEmpty()) {
            skPref.setSummary(sp.getString(CONSTS.KEY_PREF_SUBSCRIBER_KEY, ""));
        }

        skPref.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {

            @Override
            public boolean onPreferenceClick(Preference preference) {

                PreferenceScreen prefSet = getPreferenceScreen();

                final EditTextPreference skETP = (EditTextPreference) prefSet.findPreference(CONSTS.KEY_PREF_SUBSCRIBER_KEY);

                final AlertDialog d = (AlertDialog) skETP.getDialog();
                final EditText skET = skETP.getEditText();
                skET.setText(sp.getString(CONSTS.KEY_PREF_SUBSCRIBER_KEY, ""));

                Button b = d.getButton(AlertDialog.BUTTON_POSITIVE);
                b.setOnClickListener(new View.OnClickListener() {

                    @Override
                    public void onClick(android.view.View v) {
                        String newSubscriberKey = skET.getText().toString().trim();
                        if (newSubscriberKey.isEmpty()) {
                            Utils.flashError(skET, getString(R.string.error_cannot_be_blank));
                            return;
                        } else {

                            // save the preference to Shared Preferences
                            updatePreferencesForKey(CONSTS.KEY_PREF_SUBSCRIBER_KEY, newSubscriberKey);
                            skPref.setSummary(newSubscriberKey);

                            try {
                                ETPush.getInstance().setSubscriberKey(newSubscriberKey);
                            } catch (ETException e) {
                                if (ETPush.getLogLevel() <= Log.ERROR) {
                                    Log.e(TAG, e.getMessage(), e);
                                }
                            }
                        }

                        d.dismiss();
                    }
                });

                return true;
            }
        });
    }
    …
    …
}
~~~ 